import json
import urlparse
import webbrowser
import requests

def main():
	redirect_url = 'https://status.github.com/messages'
	with open('scrapeTarget_phase1.json') as file:
		data = json.load(file)

	for url in data:
		for item in data[url]:
			for param in item['params']:
				if param['name'] == 'redirect' or param['name'] == 'url':

					path = urlparse.urljoin(url, item['path'])
					updated_path = path[:path.index('?')]
					final_url = updated_path + '?{0}={1}'.format(param['name'], redirect_url)
					
					r = requests.get(final_url)
					if r.status_code != 200:
						print 'Payload did not work'
					else:
						# Payload was successful
						# Generate exploit script
						webbrowser.open_new_tab(final_url)



main()